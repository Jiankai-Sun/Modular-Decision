#!/bin/bash

#train on local machine
docker kill $(docker ps -q)
kill -9 $(lsof -t -i:2000)
python baselines/gail/run_simulators_docker.py --ip_num 1 --town 3
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task train --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 200 --g_step 1 --d_step 1 --d_model origin --train_mode all --batch_size 256 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 0.2 --init_std 1.0 --spawn_mode random --seed 2 --save_per_iter 2 --sync --other_cars 0 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --rew_type --expert_path ../log/OverTake_TRPO_curriculum_hand.pkl --load_model_path ./TRPO_checkpoint/20190903123623_trpoDMshortL5_EmptyDMbaseline_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_OtherLeadingVehicle_CurSp0STD1.0_Reg2.0_DLR1e-05_Batch256_all_G0.995.G_1.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model998.ckpt
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task train --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 800 --g_step 3 --d_step 1 --d_model origin --train_mode all --batch_size 1024 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 0.2 --init_std 1.0 --spawn_mode random --seed 1 --save_per_iter 2 --sync --other_cars 0 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --overtake_curriculum 2 --scenario_name Cross_Join --expert_path ../log/EmptyTown_CL.pkl --load_model_path ./GAIL_checkpoint/20190910201648_trpo_GAIL.DMshortL5_EmptyLateralHardVel_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.2_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model304.ckpt
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task evaluate --res 1024x768 --render --num_trajectories 100 --num_length 200 --episode_length 600 --g_step 3 --d_step 1 --d_model origin --train_mode all --batch_size 600 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 20 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 0.2 --init_std 1.0 --spawn_mode random --seed 1 --save_per_iter 2 --sync --other_cars 0 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --overtake_curriculum 2 --scenario_name Cross_Join --expert_path ../log/EmptyTown_DM.pkl #--load_model_path ./GAIL_checkpoint/20190915232822_trpo_GAIL.DMshortL5_EmptyDMEmpty_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.2_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model246.ckpt #20190909173028_trpo_GAIL.DMshortL5_EmptyClean_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.0_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model308.ckpt
python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task evaluate --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 1200 --g_step 3 --d_step 1 --d_model origin --train_mode all --batch_size 1200 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 0.2 --init_std 1.0 --spawn_mode random --seed 1 --save_per_iter 2 --sync --other_cars 0 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --scenario_name Cross_Join --expert_path ../log/EmptyTown_DM.pkl --load_model_path ./GAIL_checkpoint/20190916221850_trpo_GAIL.DMshortL5_EmptyDMEmpty_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.2_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model346.ckpt #20190909173028_trpo_GAIL.DMshortL5_EmptyClean_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.0_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model308.ckpt
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task evaluate --res 1024x768 --render --num_trajectories 100 --num_length 200 --episode_length 1000 --g_step 3 --d_step 1 --d_model origin --train_mode all --batch_size 1000 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 0.2 --init_std 1.0 --spawn_mode random --seed 1 --save_per_iter 2 --sync --other_cars 0 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --scenario_name Cross_Join --expert_path ../log/EmptyTown_DM.pkl --load_model_path ./GAIL_checkpoint/20190918025015_trpo_GAIL.DMshortL5_EmptyDMEmpty_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.2_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model348.ckpt #20190909173028_trpo_GAIL.DMshortL5_EmptyClean_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.04nenv_1SKIP_Cross_Join_CurSp0STD1.0_Reg0.0_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_0/model308.ckpt
# Test for GAIL discriminator
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task evaluate --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 800 --g_step 1 --d_step 1 --d_model origin --train_mode all --batch_size 1024 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 0. --init_std 1.0 --spawn_mode random --seed 0 --save_per_iter 2 --sync --other_cars 0 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --scenario_name Cross_Join --expert_path ../log/EmptyTown_determin.pkl --load_model_path ./GAIL_checkpoint/20190910085332_trpo_GAIL.CLEmptyCL_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.08nenv_1SKIP_Cross_Join_CurSp0STD4.0_Reg0.0_DLR1e-05_Batch256_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_1/model424.ckpt
