#!/bin/bash

#train on local machine
docker kill $(docker ps -q)
kill -9 $(lsof -t -i:2000)
python baselines/gail/run_simulators_docker.py --ip_num 1 --town 4
# Pretrained model on cluster
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task train --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 100 --g_step 3 --d_step 1 --d_model origin --train_mode all --batch_size 128 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 5.5 --init_std 1.0 --spawn_mode random --seed 2 --save_per_iter 2 --sync --other_cars 6 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.01 --g_scratch_eps 0 --scenario --scenario_name OverTake --checkkeys ST --update_D --expert_path ../log/OverTake_TRPO_curriculum_hand.pkl --load_model_path ./GAIL_checkpoint/20190829145935_trpo_GAIL.DMshortL5_HandD_100_ST_CTE0.0Vel1.04nenv_1SKIP_OverTake_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch128_all_G0.995.G_3.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_2/model618.ckpt #--checkkeys TL #KMidlane30 #--load_model_path ./checkpoint/20190826211037_trpo_GAIL.DMshortL5_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.01nenv_1SKIP_OtherLeadingVehicle_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch16_all_G0.995.G_3.D_1.G_entcoeff_0.001.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model10.ckpt

# Pretrained model with early reset
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task train --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 100 --g_step 3 --d_step 1 --d_model origin --train_mode all --batch_size 128 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 5.5 --init_std 1.0 --spawn_mode random --seed 2 --save_per_iter 2 --sync --other_cars 6 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.01 --g_scratch_eps 0 --scenario --scenario_name OverTake --checkkeys ST --update_D --expert_path ../log/OverTake_TRPO_curriculum_hand.pkl --load_model_path ./checkpoint/20190909130736_trpo_GAIL.DMshortL5_ST_CTE0.0Vel1.01nenv_1SKIP_OverTake_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch128_all_G0.995.G_3.D_1.G_entcoeff_0.01.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model50.ckpt #--checkkeys TL #KMidlane30 #--load_model_path ./checkpoint/20190826211037_trpo_GAIL.DMshortL5_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.01nenv_1SKIP_OtherLeadingVehicle_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch16_all_G0.995.G_3.D_1.G_entcoeff_0.001.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model10.ckpt

# Pretrained model with fake rewards and early reset 
#python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task train --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 100 --g_step 1 --d_step 1 --d_model origin --train_mode all --batch_size 128 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 5.5 --init_std 1.0 --spawn_mode random --seed 2 --save_per_iter 2 --sync --other_cars 6 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --scenario --scenario_name OverTake --checkkeys ST --update_D --expert_path ../log/OverTake_TRPO_curriculum_hand.pkl --load_model_path ./checkpoint/20190907224532_trpo_GAIL.DMshortL5_ST_CTE0.0Vel1.01nenv_1SKIP_OverTake_CurSp0STD1.0_Reg5.5_DLR0.001_Batch128_all_G0.995.G_1.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model254.ckpt #--checkkeys TL #KMidlane30 #--load_model_path ./checkpoint/20190826211037_trpo_GAIL.DMshortL5_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.01nenv_1SKIP_OtherLeadingVehicle_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch16_all_G0.995.G_3.D_1.G_entcoeff_0.001.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model10.ckpt

# Pretrained model with fake rewards and early reset final version
python ./baselines/gail/parallel_carla_ray.py --host 127.0.0.1 --port 2000 --algo trpo --sn --mode wp_obj --task evaluate --res 1280x1024 --render --num_trajectories 100 --num_length 200 --episode_length 100 --g_step 1 --d_step 1 --d_model origin --train_mode all --batch_size 128 --policy_hidden_layer 2 --dis_max 1.3 --adversary_hidden_layer 1 --d_actv tanh --dim 3d --max_iters 1000 --D_skip 1 --A_skip 1 --d_lrate 0.00001 --scene all --region 5.5 --init_std 1.0 --spawn_mode random --seed 2 --save_per_iter 2 --sync --other_cars 6 --model_output DM --excute_mode short --curriculumn_threshold 10000000 --lanes 5 --p_pos 0.0 --actor_nums 1 --policy_entcoeff 0.0 --g_scratch_eps 0 --scenario --scenario_name OverTake --checkkeys ST --update_D --expert_path ../log/OverTake_TRPO_curriculum_hand.pkl --load_model_path ./checkpoint/20190910232353_trpo_GAIL.DMshortL5_ST_CTE0.0Vel1.01nenv_1SKIP_OverTake_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch128_all_G0.995.G_1.D_1.G_entcoeff_0.0.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model998.ckpt #--checkkeys TL #KMidlane30 #--load_model_path ./checkpoint/20190826211037_trpo_GAIL.DMshortL5_ST_TL_KL40_TR_KMidlane30_KMidlane25_CTE0.0Vel1.01nenv_1SKIP_OtherLeadingVehicle_CurSp0STD1.0_Reg5.5_DLR1e-05_Batch16_all_G0.995.G_3.D_1.G_entcoeff_0.001.D_entcoeff_0.001.maxkl_0.01.seed_2/models/model10.ckpt
